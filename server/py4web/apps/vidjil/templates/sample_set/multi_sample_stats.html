[[extend 'db_layout.html']]

<h3></h3>

<div>
    [[ for i in range(len(data['headers'])): ]]
        <span onclick="toogleColumn('db_table_container', [[=i+1]], 'checkbox_header_[[=data['headers'][i].replace("'","")]]')">
            <input type="checkbox" id="checkbox_header_[[=data['headers'][i].replace("'","")]]" name="Toggle visibility of column [[=data['headers'][i]]]" value="[[=data['headers'][i]]]" checked>
            [[=data['headers'][i]]]
        </span>
    [[pass]]
</div>

<div id="db_table_container">
    <table class="db_table" id="table">
        <thead>
	    <tr>
            [[ for h in data['headers']: ]]
                <th class="content [[=h]]">
                    [[=h]]
                </th>
            [[ pass ]]
            <th class="column_25"></th>
        </tr>
        </thead>
        <tbody>
            [[ for pos in range(len(data['results'])): ]]
                [[res=data['results'][pos]]]
                [[row=permitted_results[pos]]]
                <tr>
                    [[ for h in data['headers']: ]]
                    <td class="[[=h]]">
                        <span class="content [[=h]]">[[=res[h]]]</span>
                    </td>
                    [[ pass ]]
                    <td>
                       <!-- [[=row.sample_set_membership.id]]  -->
                       <a id="open_sample_result_[[=row.sample_set_membership.sequence_file_id]]" class="button" type="text/html"
                       href="[ [= http_origin]]?custom=[[=row.results_file.id]]&sample_set_id=[[=row.sample_set_membership.sample_set_id]]&config=[[=row.results_file.config_id]]"
                       onclick= "event.preventDefault();
                            if( event.which == 2 ) { window.open(this.href); }
                            else { myUrl.loadCustomUrl(db, {'custom': '[[=row.results_file.id]]', 'sample_set_id' : [[=row.sample_set_membership.sample_set_id]], 'config' : [[=row.results_file.config_id]]  } ); } "  >
                            <i class="icon-forward" title="open this sample results in client"></i>
                        </a>
                    </td>
                </tr>
            [[ pass ]]
        </tbody>
    </table>
    <table class="db_table" id="db_fixed_header"></table>

    <div> Download table in <a class="button" id="download_statsQC" onclick='m.exportStatsQC("[[=data_raw]]")'>TSV format</a>
    </div>

</div>
