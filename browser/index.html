<!doctype html>

<!-- 
  This file is part of "Vidjil" <http://bioinfo.lifl.fr/vidjil>, V(D)J repertoire browsing and analysis
  Copyright (C) 2013, 2014 by Marc Duez <marc.duez@lifl.fr> and the Vidjil Team
  Bonsai bioinformatics at LIFL (UMR CNRS 8022, Université Lille) and Inria Lille

  "Vidjil" is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  "Vidjil" is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with "Vidjil". If not, see <http://www.gnu.org/licenses/>
-->

<html>
    <head>
        <meta charset="utf-8">
        <title>Vidjil</title>
        <!--<link rel="stylesheet/less" type="text/css" href="css/style.less" />-->
        <link id="palette" rel="stylesheet" type="text/css" href="css/dark.css" /> 
        <!--[if lte IE 8]><script src="js/r2d3.js" charset="utf-8"></script><![endif]-->
        <!--[if gte IE 9]><!-->
        <script type="text/javascript" src='js/lib/d3.v3.js'></script>
        <!--<![endif]-->
        <script type="text/javascript" src="js/lib/jquery-1.9.1.min.js"></script>
        <script type="text/javascript" src='js/lib/StackBlur.js'></script>
        <script type="text/javascript" src='js/lib/jspdf.js'></script>
        <script type="text/javascript" src='js/lib/jspdf.plugin.addimage.js'></script>
        <script type="text/javascript" src='js/lib/jspdf.plugin.svgToPdf.js'></script>
        <script type="text/javascript" src='js/lib/jspdf.plugin.split_text_to_size.js'></script>
        <script type="text/javascript" src='js/lib/jspdf.plugin.standard_fonts_metrics.js'></script>
        <script type="text/javascript" src='js/lib/underscore.js'></script>
        <script type="text/javascript" src='js/lib/rgbcolor.js'></script>
        <script type="text/javascript" src='js/lib/file.js'></script>
        <script type="text/javascript" src="js/lib/less-1.5.0.min.js"></script>
        <script type="text/javascript" src='js/lib/jquery.zclip.js'></script>

        <script type="text/javascript" src='js/germline.js'></script>
        <script type="text/javascript" src='js/model.js'></script>
        <script type="text/javascript" src='js/segmenter.js'></script>
        <script type="text/javascript" src='js/list.js'></script>
        <script type="text/javascript" src="js/graph.js"> </script>
        <script type="text/javascript" src="js/scatterPlot.js"> </script>
        <script type="text/javascript" src='js/builder.js'></script>
        <script type="text/javascript" src='js/vidjil-style.js'></script>
        <script type="text/javascript" src='js/crossDomain.js'></script>
        <script type="text/javascript" src='js/pdf.js'></script>

        <!--
        <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
        <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
        -->
    </head>


    <body onload="popupMsg(msg.welcome)">

        <div id="file_menu" >
            <span class="closeButton" onclick="cancel();">X</span>

            <h2>Vidjil <span class='logo'>(beta)</span> &ndash; V(D)J repertoire browsing and analysis</h2>

            Data file (.data):<br/>
            <input id="upload_json" type="file" name="json" /></br>
            <p class='help'>The data file stores a set of clones on several points.</p>

            Analysis file (.analysis, optional):<br/>
            <input id="upload_pref" type="file" name="pref" /></br>
            <p class='help'>The analysis file stores all parameters set by the user (tags, colors, manual clusters).</p>
            <!--
            load only clones in the top <select id="limit_top" name="limit_top">
            <option value="10">10</option>	
            <option value="30">30</option>
            <option value="100">100</option>
            </select> </br></br>

            <button onclick="document.getElementById('file_menu').style.display='none';
            m.load('upload_json','upload_pref', document.getElementById('limit_top').value)">start</button> 
            -->
            <button onclick="document.getElementById('file_menu').style.display='none';
            m.load('upload_json','upload_pref', 200)">start</button> 
        </div>

        <div id="analysis_menu" >
            <span class="closeButton" onclick="cancel();">X</span>
            <h2>analysis menu</h2>

            Analysis file :<br/>
            <input id="upload_analysis" type="file" name="analysis" /></br></br>

            <button onclick="document.getElementById('analysis_menu').style.display='none';
                                    m.loadAnalysis('upload_analysis');">start</button> 
        </div>


        <!-- TOP-CONTAINER -->
        <div id="top-container">

            <div class="menu" onmouseover="showSelector('adminSelector');" style="display:none"> admin 
                <div id="adminSelector" class="selector">
                    <a id="test_load_data" class="buttonSelector" onclick="m.parseJsonData(dataTest, 100).loadGermline().initClones()">
                    test load data</a>
                </div>
            </div>

            <div class="menu" onmouseover="showSelector('loadSelector');"> file 
                <div id="loadSelector" class="selector">
                    <!-- <a class="buttonSelector" onclick="javascript:loadData()">load data/analysis</a> -->
                    <!--<a class="buttonSelector" onclick="javascript:loadAnalysis()">load analysis</a> -->
                    <a class="buttonSelector" onclick="javascript:m.saveAnalysis()">save analysis</a>
                    <!--<a class="buttonSelector" onclick="javascript:m.resetAnalysis()">reset analysis</a> -->
                    <!--<a class="buttonSelector" onclick="javascript:reset()">reset all</a> -->
                    <a class="buttonSelector" onclick="javascript:new PDF(m, 'visu2_svg')">export pdf (graph + selected clones)</a>
                </div>
            </div>

            <div id="norm" class="menu" onmouseover="showSelector('ratioSelector');"> normalize 
                <div id="ratioSelector" class="selector">
                    <!--TODO generer automatiquement-->
                    <a class="buttonSelector" onclick="m.normalization_switch(false);">off</a>
                    <a class="buttonSelector" onclick="m.normalization_switch(true);">on</a> 
                </div>
            </div>

            <div class="menu" onmouseover="showSelector('groupSelector');"> analysis 
                <div id="groupSelector" class="selector">
                    <a class="buttonSelector" onclick="sp.changeSplitMethod('gene_v', 'gene_j');">V / J (genes)</a> 
                    <a class="buttonSelector" onclick="sp.changeSplitMethod('allele_v', 'allele_j');">V / J (alleles)</a> 
                    <a class="buttonSelector" onclick="sp.changeSplitMethod('gene_v', 'n');">V / N length</a> 
                    <!--<a class="buttonSelector" onclick="sp.changeSplitMethod('gene_v', 'nSize');">V / N length + VJ deletions</a> -->
                    <a class="buttonSelector" onclick="sp.changeSplitMethod('gene_v', 'Size')">V / abundance at selected timepoint</a> 
                    <a class="buttonSelector" onclick="sp.changeSplitMethod('gene_v', 'bar')">V distribution</a> 
                </div>
            </div>

            <div class="menu" onmouseover="showSelector('colorSelector');" > color 
                <div id="colorSelector" class="selector">
                    <a class="buttonSelector" onclick="m.changeColorMethod('V');">by V</a>
                    <a class="buttonSelector" onclick="m.changeColorMethod('J');">by J</a>
                    <a class="buttonSelector" onclick="m.changeColorMethod('N2');">by N length</a>
                    <!-- <a class="buttonSelector" onclick="m.changeColorMethod('N');">by N length + VJ deletions</a> -->
                    <a class="buttonSelector" onclick="m.changeColorMethod('Tag');">by tag</a>
                    <a class="buttonSelector" onclick="m.changeColorMethod('abundance');">by abundance at selected timepoint</a>
                </div>
            </div>


            <div id="norm" class="menu" onmouseover="showSelector('displaySelector');"> display
                <div id="displaySelector" class="selector">
                    <div>
                        </br>
                        <input id="top_slider" type="range" min="5" max="100" step="5" value="10" 
                        onchange="m.displayTop(this.value)" />
                    </div>
                    <ul>
                    </ul>
                </div>
            </div>

            <div class="menu" onmouseover="showSelector('clusterSelector');" > cluster
                <div id="clusterSelector" class="selector">
                    <a class="buttonSelector" onclick="m.resetClones();">reset</a>
                    <a class="buttonSelector" onclick="m.clusterBy('_clonotype');">clonotype</a>
                    <a class="buttonSelector" onclick="m.clusterBy('V');">V gene + allele</a>
                    <a class="buttonSelector" onclick="m.clusterBy('J');">J gene + allele</a>
                    <a class="buttonSelector" onclick="m.clusterBy('_target');">target</a>
                    <a class="buttonSelector" onclick="m.clusterBy('_target.V-GENE');">target V</a>
                    <a class="buttonSelector" onclick="m.clusterBy('_target.J-GENE');">target J</a>
                </div>
            </div>

            <div id="logo" style="float: right;" onclick="popupMsg(msg.welcome)">Vidjil <span class='logo'>(beta)</span></div>

            <div style="float: right" class="menu" onmouseover="showSelector('paletteSelector');"> palette 
                <div id="paletteSelector" class="selector">
                    <a class="buttonSelector" onclick="changeStyle(solarizeD)">dark</a>
                    <a class="buttonSelector" onclick="changeStyle(solarizeL)">light</a>
                </div>
            </div>

            <div id="fps" style="float: right;"> </div>

        </div>  
        <!-- fin  div id="top-container"-->
        

        <!-- MID-CONTAINER -->
        <div id="mid-container" onmouseover="hideSelector()">
        <!-- LEFT-CONTAINER -->
            <div id="left-container">

            <div id="left">

                <div id="info"> </div>

                <div id="sort-bar">
                    sort list by 
                    <a class="button" onclick="list.sortListByV();">V</a>
                    <a class="button" onclick="list.sortListByJ();">J</a>
                    <a class="button" onclick="list.sortListBySize();">abundance</a>
                </div>

                <div id="listClones"></div>

                <div id="listSelect"></div>

            </div>

            </div>
        <!-- fin left-container -->

            <div id="vertical-separator">
                <div id="toggle-left-container">
                    &lt; &lt; &lt;
                </div>
            </div>

        <!-- RIGHT-CONTAINER -->
            <div id="right-container">
                
            </div>

        <!-- VISU-CONTAINER  -->
            <div id="visu-container">
                <!-- VISU -->
                <div id="visu2"></div>
                <div id="visu-separator" >...</div>
                <div id="visu" onclick=""></div>
            </div>

        </div>
        <!-- fin mid-container -->

        <!-- BOT-CONTAINER / SEGMENTER-CONTAINER -->
        <div id="bot-container">
            <div class="separator">
                <span id="merge" class="button" onclick="m.merge()">merge</span>
                <span id="align" class="button" onclick="segment.align()">align</span>
                <span id="toIMGT"  class="button" onclick="segment.sendTo('IMGT')">❯ to IMGT/V-QUEST</span>
                <span id="toIgBlast" class="button" onclick="segment.sendTo('igBlast')">❯ to IgBlast</span>
                <span id="toClipBoard" class="button">❯ to clipBoard</span>
            </div>

            <ul id="listSeq"></ul>
        </div>
        <!-- fin bot-container -->

        <div id="tagSelector">
            <span class="closeButton" onclick="$('#tagSelector').hide('fast')">X</span>
            <div>   tag for <span id=tag_name></span><span id=tag_id></span></div>
            <ul>
            </ul>
        </div>

        <div id="frame-container"></div>

        <div id="popup-container">
            <span class="closeButton" onclick="closePopupMsg()">X</span>
            <div id="popup-msg"></div>
        </div>

        <div id="data-container">
            <span class="closeButton" onclick="closeDataBox()">X</span>
            <div id="data-msg"></div>
        </div>

        <form id="form"></form>

    </body>

    <script type="text/javascript" src='test/dataTest.js'></script>
    <script type="text/javascript" src="js/main.js"> </script>
</html>

  
